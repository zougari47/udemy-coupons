---
import PPagination from '@/components/ui/pagination/index.astro';
import PaginationContent from '@/components/ui/pagination/content.astro';
import PaginationEllipsis from '@/components/ui/pagination/ellipsis.astro';
import PaginationItem from '@/components/ui/pagination/item.astro';
import PaginationLink from '@/components/ui/pagination/link.astro';
import PaginationNext from '@/components/ui/pagination/next.astro';
import PaginationPrevious from '@/components/ui/pagination/previous.astro';

interface Props {
  page: number;
  pathname: string;
  searchParams: URLSearchParams;
}

const { page, pathname, searchParams } = Astro.props;

const getPageUrl = (pageNum: number) => {
  const sp = new URLSearchParams(searchParams);
  sp.set('page', pageNum.toString());
  return `${pathname}?${sp.toString()}`;
};
---

<PPagination class='mb-6'>
  <PaginationContent>
    <PaginationItem>
      <PaginationPrevious href={page > 1 ? getPageUrl(page - 1) : '#'} />
    </PaginationItem>
    {
      page > 2 && (
        <PaginationItem>
          <PaginationLink href={getPageUrl(1)}>1</PaginationLink>
        </PaginationItem>
      )
    }
    {
      page > 2 && (
        <PaginationItem>
          <PaginationEllipsis />
        </PaginationItem>
      )
    }
    {
      page > 1 && (
        <PaginationItem>
          <PaginationLink href={getPageUrl(page - 1)}>
            {page - 1}
          </PaginationLink>
        </PaginationItem>
      )
    }
    <PaginationItem>
      <PaginationLink href={getPageUrl(page)} isActive>{page}</PaginationLink>
    </PaginationItem>
    <PaginationItem>
      <PaginationLink href={getPageUrl(page + 1)}>{page + 1}</PaginationLink>
    </PaginationItem>
    <PaginationItem>
      <PaginationEllipsis />
    </PaginationItem>
    <PaginationItem>
      <PaginationNext href={getPageUrl(page + 1)} />
    </PaginationItem>
  </PaginationContent>
</PPagination>
